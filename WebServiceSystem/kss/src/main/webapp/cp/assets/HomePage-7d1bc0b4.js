import{d as N,u as E,U as m,V as M,r as w,o as W,W as A,b,e as r,I as f,i as t,w as s,f as j,k as e,j as h,X as V,l as o,t as a,h as Y,Y as F,Z as G,J,$ as X,a0 as T,a1 as C,a2 as Z,a3 as B}from"./index-53093fce.js";import{d as K}from"./duration-585bb4b1.js";import{q as Q,a as tt,b as et}from"./stat-44c6c647.js";import{q as st,a as at}from"./content-428531a8.js";import{q as nt}from"./interaction-a73f4759.js";const lt={class:"mb-3 shadow-md bg-warning-lighter"},ot={class:"flex items-center justify-between px-4 py-3 text-xl text-warning"},it={class:"flex items-center"},rt={class:"mb-3 shadow-md bg-warning-lighter"},ut={class:"flex items-center justify-between px-4 py-3 text-xl text-warning"},dt={class:"flex items-center"},ct={class:"mb-3 shadow-md bg-warning-lighter"},vt={class:"flex items-center justify-between px-4 py-3 text-xl text-warning"},ft={class:"flex items-center"},pt={class:"p-3 app-block"},_t={class:"text-sm text-gray-secondary"},yt={class:"flex items-end justify-between mt-1"},mt={class:"text-3xl text-primary"},ht={class:"flex items-center justify-center w-12 h-12 text-xl text-white rounded bg-primary"},gt={class:"flex justify-between pt-2 mt-3 text-xs border-t text-gray-regular"},xt={class:"p-3 app-block"},wt={class:"text-sm text-gray-secondary"},bt={class:"flex items-end justify-between mt-1"},Ct={class:"text-3xl text-primary"},kt={class:"flex items-center justify-center w-12 h-12 text-xl text-white rounded bg-warning"},$t={class:"flex justify-between pt-2 mt-3 text-xs border-t text-gray-regular"},St={class:"p-3 app-block"},jt={class:"text-sm text-gray-secondary"},Vt={class:"flex items-end justify-between mt-1"},Yt={class:"text-3xl text-primary"},Dt={class:"flex items-center justify-center w-12 h-12 text-xl text-white rounded bg-success"},qt={class:"flex justify-between pt-2 mt-3 text-xs border-t text-gray-regular"},Mt={class:"p-3 app-block"},At={class:"text-sm text-gray-secondary"},Tt={class:"flex items-end justify-between mt-1"},Bt={class:"text-3xl text-primary"},Pt={class:"flex items-center justify-center w-12 h-12 text-xl text-white rounded bg-danger"},Rt={class:"flex justify-between pt-2 mt-3 text-xs border-t text-gray-regular"},Ot={class:"px-3 py-5 mt-3 app-block"},zt={class:"flex p-3 mt-3 justify-evenly app-block"},Ht={class:"h-64 w-60 text-primary"},It={class:"mt-2 text-center"},Lt={class:"flex items-center justify-center mt-2"},Ut={class:"text-3xl"},Nt={key:0},Et={key:1},Wt={class:"mt-4 space-y-2 text-sm"},Ft={key:0},Gt={key:1},Jt={key:0},Xt={key:1},Zt={key:0},Kt={key:1},Qt={class:"h-64 w-60 text-gray-secondary"},te={class:"mt-2 text-center"},ee={class:"flex items-center justify-center mt-2"},se={class:"text-3xl"},ae={key:0},ne={key:1},le={class:"mt-4 space-y-2 text-sm"},oe={key:0},ie={key:1},re={key:0},ue={key:1},de={key:0},ce={key:1},ve={class:"p-3 mt-3 app-block"},ge=N({__name:"HomePage",setup(fe){const{t:x,n:P}=E();m.extend(K);const D=M(),R=async()=>{const n=await Q({begin:m().startOf("day").subtract(1,"day").format(),end:m().endOf("day").format()}),i={tooltip:{trigger:"axis"},legend:{data:[x("visitTrend.yesterdayPv"),x("visitTrend.todayPv")]},grid:{left:16,right:16,top:40,bottom:0,containLabel:!0},xAxis:{type:"category",boundaryGap:!1,axisTick:{show:!1},data:Array.from(Array(24).keys())},yAxis:{type:"value",minInterval:1},series:[{name:x("visitTrend.yesterdayPv"),type:"line",symbol:"circle",color:"#a0cfff",data:n.filter(l=>m(l.date)<m().startOf("day")).map(l=>l.pvCount)},{name:x("visitTrend.todayPv"),type:"line",symbol:"circle",color:"#409eff",areaStyle:{color:"#ecf5ff"},data:n.filter(l=>m(l.date)>=m().startOf("day")).map(l=>l.pvCount)}]},v=D.value;if(v==null)return;let c=C.getInstanceByDom(v);c==null&&(c=C.init(v)),c.setOption(i),window.addEventListener("resize",function(){c&&c.resize()})},q=M(),O=async()=>{const n=await tt({begin:m().subtract(30,"day").format("YYYY-MM-DD"),end:m().format("YYYY-MM-DD")}),i={title:{text:x("menu.stat.visitSource"),textStyle:{color:"#909399",fontWeight:"normal",fontSize:16}},legend:{type:"scroll",orient:"vertical",right:"10%",top:16,bottom:16},tooltip:{trigger:"item",valueFormatter:l=>P(l)},series:[{name:x("menu.stat.visitSource"),type:"pie",radius:["44%","80%"],center:["40%","54%"],avoidLabelOverlap:!1,itemStyle:{borderRadius:4,borderColor:"#fff",borderWidth:2},label:{show:!1},emphasis:{label:{show:!1}},labelLine:{show:!1},data:n.map(l=>({value:l.pvCount,name:x(`visitSource.type.${l.name}`)}))}]},v=q.value;if(v==null)return;let c=C.getInstanceByDom(v);c==null&&(c=C.init(v)),c.setOption(i),window.addEventListener("resize",function(){c&&c.resize()})},u=w({}),d=w({}),z=async()=>{const n=await et({begin:m().subtract(30,"day").format("YYYY-MM-DD"),end:m().format("YYYY-MM-DD")});u.value=n.newVisitor,d.value=n.oldVisitor;const i=u.value.uvCount+d.value.uvCount;i>0?(u.value.proportion=u.value.uvCount*100/i,d.value.proportion=d.value.uvCount*100/i):(u.value.proportion=50,d.value.proportion=50)},g=w({}),H=async()=>{g.value=await Z()},k=w(0),I=async()=>{B.epRank>=1&&(k.value=await st())},$=w(0),L=async()=>{B.epRank>=1&&($.value=await at())},S=w(0),U=async()=>{S.value=await nt()};return W(async()=>{A("articleReview:list")&&(I(),L()),A("messageBoard:list")&&U(),R(),O(),z(),H()}),(n,i)=>{const v=b("el-icon"),c=b("el-link"),l=b("el-col"),y=b("el-row");return r(),f("div",null,[t(y,{gutter:12},{default:s(()=>[k.value>0?(r(),j(l,{key:0,span:6},{default:s(()=>[e("div",lt,[e("div",ot,[e("div",it,[t(v,null,{default:s(()=>[t(h(V))]),_:1}),t(c,{class:"ml-1 text-base",type:"warning",underline:!1,onClick:i[0]||(i[0]=()=>n.$router.push({path:"/content/article-review"}))},{default:s(()=>[o(a(n.$t("todo.pendingArticle")),1)]),_:1})]),e("div",null,[t(c,{class:"ml-1 text-xl",type:"warning",underline:!1,onClick:i[1]||(i[1]=()=>n.$router.push({path:"/content/article-review"}))},{default:s(()=>[o(a(k.value),1)]),_:1})])])])]),_:1})):Y("",!0),$.value>0?(r(),j(l,{key:1,span:6},{default:s(()=>[e("div",rt,[e("div",ut,[e("div",dt,[t(v,null,{default:s(()=>[t(h(V))]),_:1}),t(c,{class:"ml-1 text-base",type:"warning",underline:!1,onClick:i[2]||(i[2]=()=>n.$router.push({path:"/content/article",query:{status:22}}))},{default:s(()=>[o(a(n.$t("todo.rejectedArticle")),1)]),_:1})]),e("div",null,[t(c,{class:"ml-1 text-xl",type:"warning",underline:!1,onClick:i[3]||(i[3]=()=>n.$router.push({path:"/content/article",query:{status:22}}))},{default:s(()=>[o(a($.value),1)]),_:1})])])])]),_:1})):Y("",!0),S.value>0?(r(),j(l,{key:2,span:6},{default:s(()=>[e("div",ct,[e("div",vt,[e("div",ft,[t(v,null,{default:s(()=>[t(h(V))]),_:1}),t(c,{class:"ml-1 text-base",type:"warning",underline:!1,onClick:i[4]||(i[4]=()=>n.$router.push({path:"/interaction/message-board",query:{status:1}}))},{default:s(()=>[o(a(n.$t("todo.unreviewedMessageBoard")),1)]),_:1})]),e("div",null,[t(c,{class:"ml-1 text-xl",type:"warning",underline:!1,onClick:i[5]||(i[5]=()=>n.$router.push({path:"/interaction/message-board",query:{status:1}}))},{default:s(()=>[o(a(S.value),1)]),_:1})])])])]),_:1})):Y("",!0)]),_:1}),t(y,{gutter:12},{default:s(()=>[t(l,{span:6},{default:s(()=>{var p,_;return[e("div",pt,[e("div",_t,a(n.$t("contentStat.article")),1),e("div",yt,[e("div",mt,a((p=g.value.article)==null?void 0:p.total),1),e("div",ht,[t(v,null,{default:s(()=>[t(h(F))]),_:1})])]),e("div",gt,[e("div",null,a(n.$t("contentStat.last7day")),1),e("div",null,a((_=g.value.article)==null?void 0:_.last7day),1)])])]}),_:1}),t(l,{span:6},{default:s(()=>{var p,_;return[e("div",xt,[e("div",wt,a(n.$t("contentStat.channel")),1),e("div",bt,[e("div",Ct,a((p=g.value.channel)==null?void 0:p.total),1),e("div",kt,[t(v,null,{default:s(()=>[t(h(G))]),_:1})])]),e("div",$t,[e("div",null,a(n.$t("contentStat.last7day")),1),e("div",null,a((_=g.value.channel)==null?void 0:_.last7day),1)])])]}),_:1}),t(l,{span:6},{default:s(()=>{var p,_;return[e("div",St,[e("div",jt,a(n.$t("contentStat.user")),1),e("div",Vt,[e("div",Yt,a((p=g.value.user)==null?void 0:p.total),1),e("div",Dt,[t(v,null,{default:s(()=>[t(h(J))]),_:1})])]),e("div",qt,[e("div",null,a(n.$t("contentStat.last7day")),1),e("div",null,a((_=g.value.user)==null?void 0:_.last7day),1)])])]}),_:1}),t(l,{span:6},{default:s(()=>{var p,_;return[e("div",Mt,[e("div",At,a(n.$t("contentStat.attachment")),1),e("div",Tt,[e("div",Bt,a((p=g.value.attachment)==null?void 0:p.total),1),e("div",Pt,[t(v,null,{default:s(()=>[t(h(X))]),_:1})])]),e("div",Rt,[e("div",null,a(n.$t("contentStat.last7day")),1),e("div",null,a((_=g.value.attachment)==null?void 0:_.last7day),1)])])]}),_:1})]),_:1}),e("div",Ot,[e("div",{ref_key:"trendChart",ref:D,class:"h-64"},null,512)]),t(y,{gutter:12},{default:s(()=>[t(l,{span:12},{default:s(()=>{var p,_;return[e("div",zt,[e("div",Ht,[e("div",It,a(n.$t("visitVisitor.newVisitor")),1),e("div",Lt,[t(v,{class:"text-5xl"},{default:s(()=>[t(h(T))]),_:1}),e("span",Ut,[u.value.uvCount>0?(r(),f("span",Nt,a(n.$n((p=u.value.proportion)!=null?p:0,"decimal")),1)):(r(),f("span",Et,"-")),o("% ")])]),e("div",Wt,[t(y,{gutter:24},{default:s(()=>[t(l,{span:12,class:"text-right"},{default:s(()=>[o(a(n.$t("visitVisitor.pv")),1)]),_:1}),t(l,{span:12},{default:s(()=>[o(a(u.value.pvCount),1)]),_:1})]),_:1}),t(y,{gutter:24},{default:s(()=>[t(l,{span:12,class:"text-right"},{default:s(()=>[o(a(n.$t("visitVisitor.uv")),1)]),_:1}),t(l,{span:12},{default:s(()=>[o(a(u.value.uvCount),1)]),_:1})]),_:1}),t(y,{gutter:24},{default:s(()=>[t(l,{span:12,class:"text-right"},{default:s(()=>[o(a(n.$t("visit.bounceRate")),1)]),_:1}),t(l,{span:12},{default:s(()=>[u.value.uvCount>0?(r(),f("span",Ft,a(n.$n(u.value.bounceCount*100/u.value.uvCount,"decimal"))+"%",1)):(r(),f("span",Gt,"-"))]),_:1})]),_:1}),t(y,{gutter:24},{default:s(()=>[t(l,{span:12,class:"text-right"},{default:s(()=>[o(a(n.$t("visit.averageDuration")),1)]),_:1}),t(l,{span:12},{default:s(()=>[u.value.uvCount>0?(r(),f("span",Jt,a(h(m).duration(u.value.duration/u.value.uvCount,"seconds").format("HH:mm:ss")),1)):(r(),f("span",Xt,"-"))]),_:1})]),_:1}),t(y,{gutter:24},{default:s(()=>[t(l,{span:12,class:"text-right"},{default:s(()=>[o(a(n.$t("visit.averagePv")),1)]),_:1}),t(l,{span:12},{default:s(()=>[u.value.uvCount>0?(r(),f("span",Zt,a(n.$n(u.value.pvCount/u.value.uvCount,"decimal")),1)):(r(),f("span",Kt,"-"))]),_:1})]),_:1})])]),e("div",Qt,[e("div",te,a(n.$t("visitVisitor.oldVisitor")),1),e("div",ee,[t(v,{class:"text-5xl"},{default:s(()=>[t(h(T))]),_:1}),e("span",se,[d.value.uvCount>0?(r(),f("span",ae,a(n.$n((_=d.value.proportion)!=null?_:0,"decimal")),1)):(r(),f("span",ne,"-")),o("% ")])]),e("div",le,[t(y,{gutter:24},{default:s(()=>[t(l,{span:12,class:"text-right"},{default:s(()=>[o(a(n.$t("visitVisitor.pv")),1)]),_:1}),t(l,{span:12},{default:s(()=>[o(a(d.value.pvCount),1)]),_:1})]),_:1}),t(y,{gutter:24},{default:s(()=>[t(l,{span:12,class:"text-right"},{default:s(()=>[o(a(n.$t("visitVisitor.uv")),1)]),_:1}),t(l,{span:12},{default:s(()=>[o(a(d.value.uvCount),1)]),_:1})]),_:1}),t(y,{gutter:24},{default:s(()=>[t(l,{span:12,class:"text-right"},{default:s(()=>[o(a(n.$t("visit.bounceRate")),1)]),_:1}),t(l,{span:12},{default:s(()=>[d.value.uvCount>0?(r(),f("span",oe,a(n.$n(d.value.bounceCount*100/d.value.uvCount,"decimal"))+"%",1)):(r(),f("span",ie,"-"))]),_:1})]),_:1}),t(y,{gutter:24},{default:s(()=>[t(l,{span:12,class:"text-right"},{default:s(()=>[o(a(n.$t("visit.averageDuration")),1)]),_:1}),t(l,{span:12},{default:s(()=>[d.value.uvCount>0?(r(),f("span",re,a(h(m).duration(d.value.duration/d.value.uvCount,"seconds").format("HH:mm:ss")),1)):(r(),f("span",ue,"-"))]),_:1})]),_:1}),t(y,{gutter:24},{default:s(()=>[t(l,{span:12,class:"text-right"},{default:s(()=>[o(a(n.$t("visit.averagePv")),1)]),_:1}),t(l,{span:12},{default:s(()=>[d.value.uvCount>0?(r(),f("span",de,a(n.$n(d.value.pvCount/d.value.uvCount,"decimal")),1)):(r(),f("span",ce,"-"))]),_:1})]),_:1})])])])]}),_:1}),t(l,{span:12},{default:s(()=>[e("div",ve,[e("div",{ref_key:"sourceTypeChart",ref:q,class:"w-full h-64"},null,512)])]),_:1})]),_:1})])}}});export{ge as default};
