import{d as U,r,b as f,e as h,f as E,w as s,j as t,i as e,as as M,u as x,a6 as G,o as H,av as J,c as K,I as W,k as C,g as X,aw as Y,E as q,aD as Z,l as $,t as w,an as _,ae as ee,ab as ae,a8 as le,ay as se}from"./index-53093fce.js";import{S as te}from"./sortable.esm-c0d7cc14.js";import{a4 as oe,a5 as ne,a6 as de,a7 as N,a8 as re,a9 as ie}from"./config-61e6aebd.js";import{a as ue,_ as me,b as pe,c as ce}from"./QueryItem.vue_vue_type_script_setup_true_lang-94058d51.js";import{_ as fe}from"./DialogForm.vue_vue_type_script_setup_true_lang-8e1e8f21.js";const be={name:"MessageBoardTypeForm"},ve=U({...be,props:{modelValue:{type:Boolean,required:!0},beanId:{type:Number,default:null},beanIds:{type:Array,required:!0}},emits:{"update:modelValue":null,finished:null},setup(B){const g=r(),i=r({});return(u,o)=>{const m=f("el-input"),b=f("el-form-item");return h(),E(fe,{values:i.value,"onUpdate:values":o[2]||(o[2]=n=>i.value=n),name:u.$t("menu.config.messageBoardType"),"query-bean":t(oe),"create-bean":t(ne),"update-bean":t(de),"delete-bean":t(N),"bean-id":B.beanId,"bean-ids":B.beanIds,focus:g.value,"init-values":()=>({}),"to-values":n=>({...n}),"model-value":B.modelValue,perms:"messageBoardType","onUpdate:modelValue":o[3]||(o[3]=n=>u.$emit("update:modelValue",n)),onFinished:o[4]||(o[4]=()=>u.$emit("finished"))},{default:s(({})=>[e(b,{prop:"name",rules:{required:!0,message:()=>u.$t("v.required")}},{label:s(()=>[e(M,{message:"messageBoardType.name"})]),default:s(()=>[e(m,{ref_key:"focus",ref:g,modelValue:i.value.name,"onUpdate:modelValue":o[0]||(o[0]=n=>i.value.name=n),maxlength:"30"},null,8,["modelValue"])]),_:1},8,["rules"]),e(b,{prop:"description"},{label:s(()=>[e(M,{message:"messageBoardType.description"})]),default:s(()=>[e(m,{modelValue:i.value.description,"onUpdate:modelValue":o[1]||(o[1]=n=>i.value.description=n),type:"textarea",rows:3,maxlength:"300"},null,8,["modelValue"])]),_:1})]),_:1},8,["values","name","query-bean","create-bean","update-bean","delete-bean","bean-id","bean-ids","focus","to-values","model-value"])}}}),ye={class:"mb-3"},ge={class:"space-x-2"},_e={class:"mt-3 app-block"},Be={name:"MessageBoardTypeList"},Ce=U({...Be,setup(B){const{t:g}=x(),i=r({}),u=r(),o=r(),m=r([]),b=r([]),n=r(!1),T=r(!1),V=r(),z=G(()=>m.value.map(a=>a.id)),D=r(!1),v=async()=>{n.value=!0;try{m.value=await re({...Y(i.value),Q_OrderBy:u.value}),D.value=u.value!==void 0}finally{n.value=!1}};let k;const F=()=>{const a=document.querySelector("#dataTable .el-table__body-wrapper tbody");k=te.create(a,{handle:".drag-handle",onEnd:async function(l){const{oldIndex:d,newIndex:c}=l;d!==c&&(await ie(m.value[d].id,m.value[c].id),m.value.splice(c,0,m.value.splice(d,1)[0]),q.success(g("success")))}})};H(()=>{v(),F()}),J(()=>{k!==void 0&&k.destroy()});const R=({column:a,prop:l,order:d})=>{var c;l&&d?u.value=((c=a.sortBy)!=null?c:l)+(d==="descending"?"_desc":""):u.value=void 0,v()},A=()=>v(),L=()=>{o.value.clearSort(),Z(i.value),u.value=void 0,v()},O=()=>{V.value=void 0,T.value=!0},I=a=>{V.value=a,T.value=!0},S=async a=>{await N(a),v(),q.success(g("success"))};return(a,l)=>{const d=f("el-button"),c=f("el-popconfirm"),y=f("el-table-column"),P=f("el-icon"),Q=f("el-table"),j=K("loading");return h(),W("div",null,[C("div",ye,[e(t(me),{params:i.value,onSearch:A,onReset:l[0]||(l[0]=()=>L())},{default:s(()=>[e(t(ue),{label:a.$t("messageBoardType.name"),name:"Q_Contains_name"},null,8,["label"])]),_:1},8,["params"])]),C("div",ge,[e(d,{type:"primary",disabled:t(_)("messageBoardType:create"),icon:t(ee),onClick:l[1]||(l[1]=()=>O())},{default:s(()=>[$(w(a.$t("add")),1)]),_:1},8,["disabled","icon"]),e(c,{title:a.$t("confirmDelete"),onConfirm:l[2]||(l[2]=()=>S(b.value.map(p=>p.id)))},{reference:s(()=>[e(d,{disabled:b.value.length<=0||t(_)("messageBoardType:delete"),icon:t(ae)},{default:s(()=>[$(w(a.$t("delete")),1)]),_:1},8,["disabled","icon"])]),_:1},8,["title"]),e(t(pe),{name:"messageBoardType"})]),C("div",_e,[X((h(),E(Q,{id:"dataTable",ref_key:"table",ref:o,"row-key":"id",data:m.value,onSelectionChange:l[3]||(l[3]=p=>b.value=p),onRowDblclick:l[4]||(l[4]=p=>I(p.id)),onSortChange:R},{default:s(()=>[e(t(ce),{name:"messageBoardType"},{default:s(()=>[e(y,{type:"selection",width:"38"}),e(y,{width:"42"},{default:s(()=>[e(P,{class:le(["text-lg align-middle text-gray-secondary",D.value||t(_)("messageBoardType:update")?["cursor-not-allowed","text-gray-disabled"]:["cursor-move","text-gray-regular","drag-handle"]]),disalbed:""},{default:s(()=>[e(t(se))]),_:1},8,["class"])]),_:1}),e(y,{property:"id",label:"ID",width:"80",sortable:"custom"}),e(y,{property:"name",label:a.$t("messageBoardType.name"),sortable:"custom","min-width":120,"show-overflow-tooltip":""},null,8,["label"]),e(y,{property:"description",label:a.$t("messageBoardType.description"),sortable:"custom","min-width":240,"show-overflow-tooltip":""},null,8,["label"]),e(y,{label:a.$t("table.action")},{default:s(({row:p})=>[e(d,{type:"primary",disabled:t(_)("messageBoardType:update"),size:"small",link:"",onClick:()=>I(p.id)},{default:s(()=>[$(w(a.$t("edit")),1)]),_:2},1032,["disabled","onClick"]),e(c,{title:a.$t("confirmDelete"),onConfirm:()=>S([p.id])},{reference:s(()=>[e(d,{type:"primary",disabled:t(_)("messageBoardType:delete"),size:"small",link:""},{default:s(()=>[$(w(a.$t("delete")),1)]),_:1},8,["disabled"])]),_:2},1032,["title","onConfirm"])]),_:1},8,["label"])]),_:1})]),_:1},8,["data"])),[[j,n.value]])]),e(ve,{modelValue:T.value,"onUpdate:modelValue":l[5]||(l[5]=p=>T.value=p),"bean-id":V.value,"bean-ids":z.value,onFinished:l[6]||(l[6]=()=>v())},null,8,["modelValue","bean-id","bean-ids"])])}}});export{Ce as default};
