import{d as P,r as V,b as f,e as r,f as U,w as a,j as t,i as e,I as q,ah as O,l as H,t as F,ag as I,p as te,u as de,v as re,h as S,k as J,m as fe,a3 as ne,E as oe,H as ie,as as ae,a8 as me,ao as ce,_ as ve,a6 as ye,o as Ve,c as ge,g as _e,aw as $e,aD as ke,aM as Ue,an as A,ae as he,ab as Te}from"./index-53093fce.js";import{J as ue,K as Me,L as Y,M as be,c as Se,q as qe,N as we}from"./config-61e6aebd.js";import{a as Ce,_ as Ie,b as Fe,c as He}from"./QueryItem.vue_vue_type_script_setup_true_lang-94058d51.js";import{_ as De}from"./ListMove.vue_vue_type_script_setup_true_lang-f8c04430.js";import{_ as Le}from"./DialogForm.vue_vue_type_script_setup_true_lang-8e1e8f21.js";import{g as se,m as X}from"./data-619fd67e.js";import{d as pe}from"./vuedraggable.umd-6a21d6e3.js";import{_ as ze}from"./FieldItem.vue_vue_type_script_setup_true_lang-8a53b42b.js";import{R as Ee}from"./content-428531a8.js";import"./sortable.esm-c0d7cc14.js";import"./Tinymce-683f8417.js";import"./FileListUpload.vue_vue_type_style_index_0_scoped_8f839ee5_lang-ab60634e.js";import"./BaseUpload-a59ce225.js";/* empty css                                                                   */const Ne={name:"ModelForm"},Oe=P({...Ne,props:{modelValue:{type:Boolean,required:!0},beanId:{type:Number,default:null},beanIds:{type:Array,required:!0},modelType:{type:String,required:!0}},emits:{"update:modelValue":null,finished:null},setup(D){const K=V(),l=V({});return($,y)=>{const k=f("el-input"),u=f("el-form-item"),o=f("el-radio"),h=f("el-radio-group"),s=f("el-option"),g=f("el-select");return r(),U(Le,{values:l.value,"onUpdate:values":y[3]||(y[3]=b=>l.value=b),name:$.$t("menu.config.model"),"query-bean":t(ue),"create-bean":t(Me),"update-bean":t(Y),"delete-bean":t(be),"bean-id":D.beanId,"bean-ids":D.beanIds,focus:K.value,"init-values":()=>({type:D.modelType,scope:0}),"to-values":b=>({...b}),"disable-delete":b=>b.id<=10,perms:"model","model-value":D.modelValue,"onUpdate:modelValue":y[4]||(y[4]=b=>$.$emit("update:modelValue",b)),onFinished:y[5]||(y[5]=()=>$.$emit("finished"))},{default:a(({})=>[e(u,{prop:"name",label:$.$t("model.name"),rules:{required:!0,message:()=>$.$t("v.required")}},{default:a(()=>[e(k,{ref_key:"focus",ref:K,modelValue:l.value.name,"onUpdate:modelValue":y[0]||(y[0]=b=>l.value.name=b),maxlength:"50"},null,8,["modelValue"])]),_:1},8,["label","rules"]),e(u,{prop:"scope",label:$.$t("model.scope"),rules:{required:!0,message:()=>$.$t("v.required")}},{default:a(()=>[e(h,{modelValue:l.value.scope,"onUpdate:modelValue":y[1]||(y[1]=b=>l.value.scope=b),disabled:l.value.id<10},{default:a(()=>[(r(),q(I,null,O([0,2],b=>e(o,{key:b,label:b},{default:a(()=>[H(F($.$t(`model.scope.${b}`)),1)]),_:2},1032,["label"])),64))]),_:1},8,["modelValue","disabled"])]),_:1},8,["label","rules"]),e(u,{prop:"type",label:$.$t("model.type")},{default:a(()=>[e(g,{modelValue:l.value.type,"onUpdate:modelValue":y[2]||(y[2]=b=>l.value.type=b),disabled:""},{default:a(()=>[e(s,{value:D.modelType,label:$.$t(`model.type.${D.modelType}`)},null,8,["value","label"])]),_:1},8,["modelValue"])]),_:1},8,["label"])]),_:1},8,["values","name","query-bean","create-bean","update-bean","delete-bean","bean-id","bean-ids","focus","init-values","to-values","disable-delete","model-value"])}}}),Ke={class:"mt-3"},Re={name:"ModelSystemFields"},We=P({...Re,props:{modelValue:{type:Boolean,required:!0},beanId:{type:Number,default:null}},emits:{"update:modelValue":null},setup(D,{emit:K}){const l=D,{beanId:$,modelValue:y}=te(l),{t:k}=de(),u=V({}),o=V(!1),h=V([]),s=V([]);re(y,async()=>{var n;if(y.value&&$.value){u.value=await ue($.value);const w=se()[u.value.type];h.value=X(w.mains.filter(C=>{var v;return ne.epRank>=((v=C.epRank)!=null?v:0)}),u.value.mains,u.value.type),((n=w.asides)==null?void 0:n.length)>0&&(s.value=X(w.asides.filter(C=>{var v;return ne.epRank>=((v=C.epRank)!=null?v:0)}),u.value.asides,u.value.type))}});const g=async()=>{o.value=!0;try{h.value=h.value.map(n=>({...n,name:n.name===""?null:n.name})),s.value=s.value.map(n=>({...n,name:n.name===""?null:n.name})),await Y({...u.value,mains:JSON.stringify(h.value),asides:JSON.stringify(s.value)}),oe.success(k("success"))}finally{o.value=!1,K("update:modelValue",!1)}},b=()=>{var w;const n=se()[u.value.type];h.value=X(n.mains,null,u.value.type),((w=n.asides)==null?void 0:w.length)>0&&(s.value=X(n.asides,null,u.value.type))};return(n,w)=>{const C=f("el-table-column"),v=f("el-input"),N=f("el-switch"),d=f("el-option"),L=f("el-select"),B=f("el-checkbox"),j=f("el-table"),T=f("el-button"),M=f("el-form"),E=f("el-dialog");return r(),U(E,{title:n.$t("model.fun.systemFields"),"model-value":D.modelValue,top:"5vh",width:"1024px","onUpdate:modelValue":w[0]||(w[0]=i=>n.$emit("update:modelValue",i))},{default:a(()=>[e(M,null,{default:a(()=>[e(j,{data:h.value},{default:a(()=>[e(C,{prop:"code",label:n.$t("model.field.code"),"min-width":"110"},null,8,["label"]),e(C,{prop:"name",label:n.$t("model.field.name"),"min-width":"140"},{default:a(({row:i})=>[e(v,{modelValue:i.name,"onUpdate:modelValue":p=>i.name=p,placeholder:n.$t(i.label),class:"w-11/12"},null,8,["modelValue","onUpdate:modelValue","placeholder"])]),_:1},8,["label"]),e(C,{prop:"show",label:n.$t("model.field.show")},{default:a(({row:i})=>[e(N,{modelValue:i.show,"onUpdate:modelValue":p=>i.show=p,disabled:i.must},null,8,["modelValue","onUpdate:modelValue","disabled"])]),_:1},8,["label"]),e(C,{prop:"double",label:n.$t("model.field.double")},{default:a(({row:i})=>[e(N,{modelValue:i.double,"onUpdate:modelValue":p=>i.double=p},null,8,["modelValue","onUpdate:modelValue"])]),_:1},8,["label"]),e(C,{prop:"required",label:n.$t("model.field.required")},{default:a(({row:i})=>[e(N,{modelValue:i.required,"onUpdate:modelValue":p=>i.required=p,disabled:i.must},null,8,["modelValue","onUpdate:modelValue","disabled"])]),_:1},8,["label"]),e(C,{label:n.$t("model.field.attribute"),"min-width":"180"},{default:a(({row:i})=>[i.type==="image"?(r(),q(I,{key:0},[e(v,{modelValue:i.imageHeight,"onUpdate:modelValue":p=>i.imageHeight=p,modelModifiers:{number:!0}},{prepend:a(()=>[H(F(n.$t("model.field.imageHeight")),1)]),_:2},1032,["modelValue","onUpdate:modelValue"]),e(v,{modelValue:i.imageWidth,"onUpdate:modelValue":p=>i.imageWidth=p,modelModifiers:{number:!0}},{prepend:a(()=>[H(F(n.$t("model.field.imageWidth")),1)]),_:2},1032,["modelValue","onUpdate:modelValue"]),e(L,{modelValue:i.imageMode,"onUpdate:modelValue":p=>i.imageMode=p,placeholder:n.$t("model.field.imageMode"),class:"w-full"},{default:a(()=>[(r(),q(I,null,O(["manual","cut","resize","none"],p=>e(d,{key:p,value:p,label:n.$t(`model.field.imageMode.${p}`)},null,8,["value","label"])),64))]),_:2},1032,["modelValue","onUpdate:modelValue","placeholder"])],64)):i.type==="imageList"?(r(),q(I,{key:1},[e(v,{modelValue:i.imageMaxHeight,"onUpdate:modelValue":p=>i.imageMaxHeight=p,modelModifiers:{number:!0}},{prepend:a(()=>[H(F(n.$t("model.field.imageMaxHeight")),1)]),_:2},1032,["modelValue","onUpdate:modelValue"]),e(v,{modelValue:i.imageMaxWidth,"onUpdate:modelValue":p=>i.imageMaxWidth=p,modelModifiers:{number:!0}},{prepend:a(()=>[H(F(n.$t("model.field.imageMaxWidth")),1)]),_:2},1032,["modelValue","onUpdate:modelValue"]),e(L,{modelValue:i.imageListType,"onUpdate:modelValue":p=>i.imageListType=p,placeholder:n.$t("model.field.imageListType"),class:"w-full"},{default:a(()=>[(r(),q(I,null,O(["pictureCard","picture"],p=>e(d,{key:p,value:p,label:n.$t(`model.field.imageListType.${p}`)},null,8,["value","label"])),64))]),_:2},1032,["modelValue","onUpdate:modelValue","placeholder"])],64)):i.type==="editor"?(r(),q(I,{key:2},[e(L,{modelValue:i.editorType,"onUpdate:modelValue":p=>i.editorType=p,placeholder:n.$t("model.field.editorType"),class:"w-full"},{default:a(()=>[(r(),q(I,null,O([1,2],p=>e(d,{key:p,value:p,label:n.$t(`model.field.editorType.${p}`)},null,8,["value","label"])),64))]),_:2},1032,["modelValue","onUpdate:modelValue","placeholder"]),e(B,{modelValue:i.editorSwitch,"onUpdate:modelValue":p=>i.editorSwitch=p},{default:a(()=>[H(F(n.$t("model.field.editorSwitch")),1)]),_:2},1032,["modelValue","onUpdate:modelValue"])],64)):S("",!0)]),_:1},8,["label"])]),_:1},8,["data"]),s.value.length>0?(r(),U(j,{key:0,data:s.value,class:"mt-5"},{default:a(()=>[e(C,{prop:"code",label:n.$t("model.field.code"),"min-width":"100"},null,8,["label"]),e(C,{prop:"name",label:n.$t("model.field.name"),"min-width":"120"},{default:a(({row:i})=>[e(v,{modelValue:i.name,"onUpdate:modelValue":p=>i.name=p,placeholder:n.$t(i.label),class:"w-11/12"},null,8,["modelValue","onUpdate:modelValue","placeholder"])]),_:1},8,["label"]),e(C,{prop:"show",label:n.$t("model.field.show")},{default:a(({row:i})=>[e(N,{modelValue:i.show,"onUpdate:modelValue":p=>i.show=p,disabled:i.must},null,8,["modelValue","onUpdate:modelValue","disabled"])]),_:1},8,["label"]),e(C,{prop:"required",label:n.$t("model.field.required")},{default:a(({row:i})=>[e(N,{modelValue:i.required,"onUpdate:modelValue":p=>i.required=p,disabled:i.must},null,8,["modelValue","onUpdate:modelValue","disabled"])]),_:1},8,["label"])]),_:1},8,["data"])):S("",!0),J("div",Ke,[e(T,{loading:o.value,type:"primary","native-type":"submit",onClick:fe(g,["prevent"])},{default:a(()=>[H(F(n.$t("save")),1)]),_:1},8,["loading","onClick"]),e(T,{onClick:b},{default:a(()=>[H(F(n.$t("restoreInitialSettings")),1)]),_:1})])]),_:1})]),_:1},8,["title","model-value"])}}}),Be=P({__name:"FieldAttribute",props:{selected:{type:Object,required:!0}},setup(D){const K=D,{selected:l}=te(K),$=V([]),y=V([]);ie(async()=>{l.value.type==="date"&&!l.value.dateType&&(l.value.dateType="date"),l.value.type==="switch"&&!l.value.inactiveValue&&(l.value.inactiveValue="0"),l.value.type==="switch"&&!l.value.activeValue&&(l.value.activeValue="1"),["radio","checkbox"].includes(l.value.type)&&!l.value.checkStyle&&(l.value.checkStyle="default"),["checkbox","multipleSelect"].includes(l.value.type)&&!l.value.defaultValue&&(l.value.defaultValue=[]),["checkbox","multipleSelect"].includes(l.value.type)&&(l.value.multiple=!0),["radio","checkbox","select","multipleSelect"].includes(l.value.type)&&($.value=await Se())}),ie(async()=>{l.value.dictTypeId!=null&&(y.value=await Ee({typeId:l.value.dictTypeId}))});const k=async()=>{l.value.defaultValue=l.value.multiple?[]:void 0,l.value.defaultValueKey=l.value.multiple?[]:void 0};return(u,o)=>{const h=f("el-input"),s=f("el-form-item"),g=f("el-switch"),b=f("el-input-number"),n=f("el-option"),w=f("el-select"),C=f("el-color-picker"),v=f("el-radio-button"),N=f("el-radio-group");return r(),q(I,null,[e(s,{prop:"code",label:u.$t("model.field.code"),rules:{required:!0,message:()=>u.$t("v.required")}},{default:a(()=>[e(h,{modelValue:t(l).code,"onUpdate:modelValue":o[0]||(o[0]=d=>t(l).code=d),maxlength:"50"},null,8,["modelValue"])]),_:1},8,["label","rules"]),e(s,{prop:"name",label:u.$t("model.field.name"),rules:{required:!0,message:()=>u.$t("v.required")}},{default:a(()=>[e(h,{modelValue:t(l).name,"onUpdate:modelValue":o[1]||(o[1]=d=>t(l).name=d),maxlength:"50"},null,8,["modelValue"])]),_:1},8,["label","rules"]),e(s,{prop:"double",label:u.$t("model.field.double")},{default:a(()=>[e(g,{modelValue:t(l).double,"onUpdate:modelValue":o[2]||(o[2]=d=>t(l).double=d)},null,8,["modelValue"])]),_:1},8,["label"]),e(s,{prop:"required",label:u.$t("model.field.required")},{default:a(()=>[e(g,{modelValue:t(l).required,"onUpdate:modelValue":o[3]||(o[3]=d=>t(l).required=d)},null,8,["modelValue"])]),_:1},8,["label"]),["text","textarea","number","select","multipleSelect","videoUpload","audioUpload","fileUpload","tinyEditor"].includes(t(l).type)?(r(),U(s,{key:0,prop:"placeholder",label:u.$t("model.field.placeholder")},{default:a(()=>[e(h,{modelValue:t(l).placeholder,"onUpdate:modelValue":o[4]||(o[4]=d=>t(l).placeholder=d),maxlength:"100"},null,8,["modelValue"])]),_:1},8,["label"])):S("",!0),["text","textarea"].includes(t(l).type)?(r(),q(I,{key:1},[e(s,{prop:"defaultValue",label:u.$t("model.field.defaultValue")},{default:a(()=>[e(h,{modelValue:t(l).defaultValue,"onUpdate:modelValue":o[5]||(o[5]=d=>t(l).defaultValue=d),maxlength:"100"},null,8,["modelValue"])]),_:1},8,["label"]),e(s,{prop:"minlength",label:u.$t("model.field.minlength")},{default:a(()=>[e(b,{modelValue:t(l).minlength,"onUpdate:modelValue":o[6]||(o[6]=d=>t(l).minlength=d),min:1},null,8,["modelValue"])]),_:1},8,["label"]),e(s,{prop:"maxlength",label:u.$t("model.field.maxlength")},{default:a(()=>[e(b,{modelValue:t(l).maxlength,"onUpdate:modelValue":o[7]||(o[7]=d=>t(l).maxlength=d),min:1},null,8,["modelValue"])]),_:1},8,["label"])],64)):S("",!0),["textarea"].includes(t(l).type)?(r(),U(s,{key:2,prop:"rows",label:u.$t("model.field.rows")},{default:a(()=>[e(b,{modelValue:t(l).rows,"onUpdate:modelValue":o[8]||(o[8]=d=>t(l).rows=d)},null,8,["modelValue"])]),_:1},8,["label"])):S("",!0),["number","slider"].includes(t(l).type)?(r(),q(I,{key:3},[e(s,{prop:"defaultValue",label:u.$t("model.field.defaultValue")},{default:a(()=>[e(b,{modelValue:t(l).defaultValue,"onUpdate:modelValue":o[9]||(o[9]=d=>t(l).defaultValue=d),min:t(l).min,max:t(l).max},null,8,["modelValue","min","max"])]),_:1},8,["label"]),e(s,{prop:"min",label:u.$t("model.field.min")},{default:a(()=>[e(b,{modelValue:t(l).min,"onUpdate:modelValue":o[10]||(o[10]=d=>t(l).min=d)},null,8,["modelValue"])]),_:1},8,["label"]),e(s,{prop:"max",label:u.$t("model.field.max")},{default:a(()=>[e(b,{modelValue:t(l).max,"onUpdate:modelValue":o[11]||(o[11]=d=>t(l).max=d)},null,8,["modelValue"])]),_:1},8,["label"]),e(s,{prop:"step",label:u.$t("model.field.step")},{default:a(()=>[e(b,{modelValue:t(l).step,"onUpdate:modelValue":o[12]||(o[12]=d=>t(l).step=d)},null,8,["modelValue"])]),_:1},8,["label"])],64)):S("",!0),["number"].includes(t(l).type)?(r(),U(s,{key:4,prop:"precision",label:u.$t("model.field.precision")},{default:a(()=>[e(b,{modelValue:t(l).precision,"onUpdate:modelValue":o[13]||(o[13]=d=>t(l).precision=d),precision:0,min:0,max:4},null,8,["modelValue"])]),_:1},8,["label"])):S("",!0),["slider"].includes(t(l).type)?(r(),U(s,{key:5,prop:"showInput",label:u.$t("model.field.showInput")},{default:a(()=>[e(g,{modelValue:t(l).showInput,"onUpdate:modelValue":o[14]||(o[14]=d=>t(l).showInput=d)},null,8,["modelValue"])]),_:1},8,["label"])):S("",!0),["date"].includes(t(l).type)?(r(),U(s,{key:6,prop:"dateType",label:u.$t("model.field.dateType")},{default:a(()=>[e(w,{modelValue:t(l).dateType,"onUpdate:modelValue":o[15]||(o[15]=d=>t(l).dateType=d)},{default:a(()=>[(r(),q(I,null,O(["date","datetime"],d=>e(n,{key:d,label:u.$t(`model.field.dateType.${d}`),value:d},null,8,["label","value"])),64))]),_:1},8,["modelValue"])]),_:1},8,["label"])):S("",!0),["color"].includes(t(l).type)?(r(),U(s,{key:7,prop:"defaultValue",label:u.$t("model.field.defaultValue")},{default:a(()=>[e(C,{modelValue:t(l).defaultValue,"onUpdate:modelValue":o[16]||(o[16]=d=>t(l).defaultValue=d)},null,8,["modelValue"])]),_:1},8,["label"])):S("",!0),["switch"].includes(t(l).type)?(r(),U(s,{key:8,prop:"defaultValue",label:u.$t("model.field.defaultValue")},{default:a(()=>[e(g,{modelValue:t(l).defaultValue,"onUpdate:modelValue":o[17]||(o[17]=d=>t(l).defaultValue=d)},null,8,["modelValue"])]),_:1},8,["label"])):S("",!0),["radio","checkbox"].includes(t(l).type)?(r(),U(s,{key:9,prop:"checkStyle",label:u.$t("model.field.checkStyle")},{default:a(()=>[e(N,{modelValue:t(l).checkStyle,"onUpdate:modelValue":o[18]||(o[18]=d=>t(l).checkStyle=d)},{default:a(()=>[(r(),q(I,null,O(["default","button"],d=>e(v,{key:d,label:d},{default:a(()=>[H(F(u.$t(`model.field.checkStyle.${d}`)),1)]),_:2},1032,["label"])),64))]),_:1},8,["modelValue"])]),_:1},8,["label"])):S("",!0),["select","multipleSelect"].includes(t(l).type)?(r(),U(s,{key:10,prop:"clearable",label:u.$t("model.field.clearable")},{default:a(()=>[e(g,{modelValue:t(l).clearable,"onUpdate:modelValue":o[19]||(o[19]=d=>t(l).clearable=d)},null,8,["modelValue"])]),_:1},8,["label"])):S("",!0),["radio","checkbox","select","multipleSelect"].includes(t(l).type)?(r(),U(s,{key:11,prop:"dictTypeId",label:u.$t("model.field.dictType"),rules:{required:!0,message:()=>u.$t("v.required")}},{default:a(()=>[e(w,{modelValue:t(l).dictTypeId,"onUpdate:modelValue":o[20]||(o[20]=d=>t(l).dictTypeId=d),class:"w-full",onChange:o[21]||(o[21]=d=>k())},{default:a(()=>[(r(!0),q(I,null,O($.value,d=>(r(),U(n,{key:d.id,value:d.id,label:`${d.name}(${d.alias})`},null,8,["value","label"]))),128))]),_:1},8,["modelValue"])]),_:1},8,["label","rules"])):S("",!0),["radio","select"].includes(t(l).type)?(r(),U(s,{key:12,prop:"defaultValue",label:u.$t("model.field.defaultValue")},{default:a(()=>[e(w,{modelValue:t(l).defaultValueKey,"onUpdate:modelValue":o[22]||(o[22]=d=>t(l).defaultValueKey=d),clearable:"",class:"w-full",onChange:o[23]||(o[23]=d=>{var L;return t(l).defaultValue=(L=y.value.find(B=>B.value===d))==null?void 0:L.name})},{default:a(()=>[(r(!0),q(I,null,O(y.value,d=>(r(),U(n,{key:d.id,value:d.value,label:d.name},null,8,["value","label"]))),128))]),_:1},8,["modelValue"])]),_:1},8,["label"])):S("",!0),["checkbox","multipleSelect"].includes(t(l).type)?(r(),U(s,{key:13,prop:"defaultValue",label:u.$t("model.field.defaultValue")},{default:a(()=>[e(w,{modelValue:t(l).defaultValueKey,"onUpdate:modelValue":o[24]||(o[24]=d=>t(l).defaultValueKey=d),clearable:"",class:"w-full",multiple:"",onChange:o[25]||(o[25]=d=>t(l).defaultValue=y.value.filter(L=>d.indexOf(L.value)!==-1).map(L=>L.name))},{default:a(()=>[(r(!0),q(I,null,O(y.value,d=>(r(),U(n,{key:d.id,value:d.value,label:d.name},null,8,["value","label"]))),128))]),_:1},8,["modelValue"])]),_:1},8,["label"])):S("",!0),["imageUpload"].includes(t(l).type)?(r(),q(I,{key:14},[e(s,{prop:"imageWidth",label:u.$t("model.field.imageWidth")},{default:a(()=>[e(b,{modelValue:t(l).imageWidth,"onUpdate:modelValue":o[26]||(o[26]=d=>t(l).imageWidth=d),min:1,max:65535},null,8,["modelValue"])]),_:1},8,["label"]),e(s,{prop:"imageHeight",label:u.$t("model.field.imageHeight")},{default:a(()=>[e(b,{modelValue:t(l).imageHeight,"onUpdate:modelValue":o[27]||(o[27]=d=>t(l).imageHeight=d),min:1,max:65535},null,8,["modelValue"])]),_:1},8,["label"]),e(s,{prop:"imageMode",label:u.$t("model.field.imageMode")},{default:a(()=>[e(w,{modelValue:t(l).imageMode,"onUpdate:modelValue":o[28]||(o[28]=d=>t(l).imageMode=d),clearable:"",class:"w-full"},{default:a(()=>[(r(),q(I,null,O(["cut","resize","manual","none"],d=>e(n,{key:d,value:d,label:u.$t(`model.field.imageMode.${d}`)},null,8,["value","label"])),64))]),_:1},8,["modelValue"])]),_:1},8,["label"])],64)):S("",!0),["imageUpload","videoUpload","audioUpload","fileUpload"].includes(t(l).type)?(r(),q(I,{key:15},[e(s,{prop:"fileAccept"},{label:a(()=>[e(ae,{message:"model.field.fileAccept",help:"","fix-width":!1})]),default:a(()=>[e(h,{modelValue:t(l).fileAccept,"onUpdate:modelValue":o[29]||(o[29]=d=>t(l).fileAccept=d),maxlength:"255"},null,8,["modelValue"])]),_:1}),e(s,{prop:"fileMaxSize",rules:{type:"number",min:0,max:65535,message:()=>u.$t("v.range",{min:0,max:65535})}},{label:a(()=>[e(ae,{message:"model.field.fileMaxSize",help:"","fix-width":!1})]),default:a(()=>[e(h,{modelValue:t(l).fileMaxSize,"onUpdate:modelValue":o[30]||(o[30]=d=>t(l).fileMaxSize=d),modelModifiers:{number:!0},maxlength:"5"},null,8,["modelValue"])]),_:1},8,["rules"])],64)):S("",!0),["tinyEditor"].includes(t(l).type)?(r(),q(I,{key:16},[e(s,{prop:"minHeight",label:u.$t("model.field.minHeight")},{default:a(()=>[e(b,{modelValue:t(l).minHeight,"onUpdate:modelValue":o[31]||(o[31]=d=>t(l).minHeight=d),min:1,max:65535},null,8,["modelValue"])]),_:1},8,["label"]),e(s,{prop:"maxHeight",label:u.$t("model.field.maxHeight")},{default:a(()=>[e(b,{modelValue:t(l).maxHeight,"onUpdate:modelValue":o[32]||(o[32]=d=>t(l).maxHeight=d),min:1,max:65535},null,8,["modelValue"])]),_:1},8,["label"])],64)):S("",!0)],64)}}}),Ae={class:"dialog-full"},Je={class:"drag-component"},je=["onClick"],Pe=["onClick"],Qe={name:"ModelCustomFields"},Ge=P({...Qe,props:{modelValue:{type:Boolean,required:!0},beanId:{type:Number,default:null}},emits:{"update:modelValue":null},setup(D,{emit:K}){const l=D,{beanId:$,modelValue:y}=te(l),{t:k}=de(),u=V({}),o=V({}),h=V(),s=V(!1),g=V(),b=V(),n=V("attribute"),w=V(!1),C=V([{label:k("model.fieldType.text"),type:"text"},{label:k("model.fieldType.textarea"),type:"textarea"},{label:k("model.fieldType.number"),type:"number"},{label:k("model.fieldType.slider"),type:"slider"},{label:k("model.fieldType.date"),type:"date"},{label:k("model.fieldType.color"),type:"color"},{label:k("model.fieldType.radio"),type:"radio"},{label:k("model.fieldType.checkbox"),type:"checkbox"},{label:k("model.fieldType.select"),type:"select"},{label:k("model.fieldType.multipleSelect"),type:"multipleSelect"},{label:k("model.fieldType.switch"),type:"switch"},{label:k("model.fieldType.imageUpload"),type:"imageUpload"},{label:k("model.fieldType.videoUpload"),type:"videoUpload"},{label:k("model.fieldType.audioUpload"),type:"audioUpload"},{label:k("model.fieldType.fileUpload"),type:"fileUpload"},{label:k("model.fieldType.tinyEditor"),type:"tinyEditor"}]),v=V([]);re(y,async()=>{y.value&&($==null?void 0:$.value)!=null&&(u.value=await ue($.value),v.value=JSON.parse(u.value.customs||"[]"),v.value.length>0?[g.value]=v.value:g.value=void 0)});const N=async T=>{if(!g.value){g.value=T;return}h.value.validate(M=>{M&&(g.value=T)})},d=T=>{const M={code:`field${Date.now()}`,type:T.type,name:T.label,double:!1};return b.value=M,M},L=T=>{T.from!==T.to&&(g.value=b.value)},B=T=>{const M=v.value.indexOf(T);v.value.splice(M,1);const{length:E}=v.value;E<=0?g.value=void 0:M<E?g.value=v.value[M]:g.value=v.value[E-1]},j=async()=>{w.value=!0;try{v.value.length>0?h.value.validate(async T=>{T&&await Y({...u.value,customs:JSON.stringify(v.value)})}):await Y({...u.value,customs:JSON.stringify(v.value)}),oe.success(k("success"))}finally{w.value=!1,K("update:modelValue",!1)}};return(T,M)=>{const E=f("el-scrollbar"),i=f("el-aside"),p=f("el-button"),c=f("el-header"),_=f("el-form-item"),z=f("el-icon"),R=f("el-col"),Q=f("el-form"),Z=f("el-main"),W=f("el-container"),G=f("el-tab-pane"),x=f("el-tabs"),ee=f("el-dialog");return r(),q("div",Ae,[e(ee,{title:T.$t("model.fun.customFields"),"model-value":D.modelValue,"destroy-on-close":"",fullscreen:"","onUpdate:modelValue":M[3]||(M[3]=m=>T.$emit("update:modelValue",m))},{default:a(()=>[e(W,{class:"border-t",style:{height:"calc(100vh - 65px)"}},{default:a(()=>[e(i,{width:"240px"},{default:a(()=>[e(E,{class:"h-full"},{default:a(()=>[e(t(pe),{list:C.value,group:{name:"components",pull:"clone",put:!1},sort:!1,clone:d,"item-key":"label",onEnd:L},{item:a(({element:m})=>[J("div",Je,F(m.label),1)]),_:1},8,["list"])]),_:1})]),_:1}),e(W,{class:"border-l border-r"},{default:a(()=>[e(c,{height:"auto",class:"px-2 py-1"},{default:a(()=>[e(p,{loading:w.value,type:"primary",onClick:fe(j,["prevent"])},{default:a(()=>[H(F(T.$t("save")),1)]),_:1},8,["loading","onClick"])]),_:1}),e(Z,{class:"p-0 border-t"},{default:a(()=>[e(E,{class:"h-full p-2 drawing-board"},{default:a(()=>[e(Q,{model:o.value,"label-width":"150px",class:"h-full"},{default:a(()=>[e(t(pe),{list:v.value,class:"content-start min-h-full mx-0",tag:"el-row","component-data":{gutter:8},animation:250,group:"components","item-key":"code",onStart:M[0]||(M[0]=()=>s.value=!0),onEnd:M[1]||(M[1]=()=>s.value=!1)},{item:a(({element:m})=>[e(R,{span:m.double?12:24,class:"relative"},{default:a(()=>[e(_,{required:m.required,"show-message":!1,class:"py-3 mb-0"},{label:a(()=>[e(ae,{label:m.name},null,8,["label"])]),default:a(()=>[e(ze,{modelValue:m.defaultValue,"onUpdate:modelValue":le=>m.defaultValue=le,"model-key":m.defaultValueKey,"onUpdate:modelKey":le=>m.defaultValueKey=le,field:m},null,8,["modelValue","onUpdate:modelValue","model-key","onUpdate:modelKey","field"])]),_:2},1032,["required"]),J("div",{class:me(["drag-mask",!s.value&&g.value!==m?"hover:opacity-10":null,g.value===m?"drag-mask-selected":null]),onClick:()=>N(m)},null,10,je),J("div",{class:me(["drag-close",g.value!==m?"hidden":null]),onClick:()=>B(m)},[e(z,{class:"text-danger"},{default:a(()=>[e(t(ce))]),_:1})],10,Pe)]),_:2},1032,["span"])]),_:1},8,["list"])]),_:1},8,["model"])]),_:1})]),_:1})]),_:1}),e(i,{class:"w-64 right-panel"},{default:a(()=>[e(E,{class:"h-full pt-0.5 pb-3"},{default:a(()=>[e(x,{modelValue:n.value,"onUpdate:modelValue":M[2]||(M[2]=m=>n.value=m),stretch:""},{default:a(()=>[e(G,{label:T.$t("model.attribute"),name:"attribute",class:"px-2"},{default:a(()=>[e(Q,{ref_key:"selectedForm",ref:h,model:g.value},{default:a(()=>[g.value?(r(),U(Be,{key:0,selected:g.value},null,8,["selected"])):S("",!0)]),_:1},8,["model"])]),_:1},8,["label"])]),_:1},8,["modelValue"])]),_:1})]),_:1})]),_:1})]),_:1},8,["title","model-value"])])}}});const Xe=ve(Ge,[["__scopeId","data-v-61e441ee"]]),Ye={class:"mb-3"},Ze={class:"app-block"},xe={name:"ModelList"},bl=P({...xe,setup(D){const{t:K}=de(),l=V({}),$=V("article"),y=V(),k=V(),u=V([]),o=V([]),h=V(!1),s=V(!1),g=V(!1),b=V(!1),n=V(),w=ye(()=>u.value.map(c=>c.id)),C=V(!1),v=async()=>{h.value=!0;try{u.value=await qe({...$e(l.value),type:$.value,Q_OrderBy:y.value}),C.value=Object.values(l.value).filter(c=>c!==void 0&&c!=="").length>0||y.value!==void 0}finally{h.value=!1}};Ve(v);const N=({column:c,prop:_,order:z})=>{var R;_&&z?y.value=((R=c.sortBy)!=null?R:_)+(z==="descending"?"_desc":""):y.value=void 0,v()},d=()=>v(),L=()=>{k.value.clearSort(),ke(l.value),y.value=void 0,v()},B=c=>{n.value=c,g.value=!0},j=c=>{n.value=c,b.value=!0},T=()=>{n.value=void 0,s.value=!0},M=c=>{n.value=c,s.value=!0},E=async c=>{await be(c),v(),oe.success(K("success"))},i=async(c,_)=>{const z=Ue(c,u.value,_);await we(z.map(R=>R.id))},p=c=>c.id>10;return(c,_)=>{const z=f("el-button"),R=f("el-popconfirm"),Q=f("el-radio-button"),Z=f("el-radio-group"),W=f("el-table-column"),G=f("el-tag"),x=f("el-table"),ee=ge("loading");return r(),q("div",null,[J("div",Ye,[e(t(Ie),{params:l.value,onSearch:d,onReset:L},{default:a(()=>[e(t(Ce),{label:c.$t("model.name"),name:"Q_Contains_name"},null,8,["label"])]),_:1},8,["params"])]),J("div",null,[e(z,{type:"primary",disabled:t(A)("model:create"),icon:t(he),onClick:_[0]||(_[0]=()=>T())},{default:a(()=>[H(F(c.$t("add")),1)]),_:1},8,["disabled","icon"]),e(R,{title:c.$t("confirmDelete"),onConfirm:_[1]||(_[1]=()=>E(o.value.map(m=>m.id)))},{reference:a(()=>[e(z,{disabled:o.value.length<=0||t(A)("model:delete"),icon:t(Te)},{default:a(()=>[H(F(c.$t("delete")),1)]),_:1},8,["disabled","icon"])]),_:1},8,["title"]),e(De,{disabled:o.value.length<=0||C.value||t(A)("org:update"),class:"ml-2",onMove:_[2]||(_[2]=m=>i(o.value,m))},null,8,["disabled"]),e(t(Fe),{name:"model",class:"ml-2"})]),e(Z,{modelValue:$.value,"onUpdate:modelValue":_[3]||(_[3]=m=>$.value=m),class:"mt-3",onChange:_[4]||(_[4]=()=>v())},{default:a(()=>[(r(),q(I,null,O(["article","channel","site","global"],m=>e(Q,{key:m,label:m},{default:a(()=>[H(F(c.$t(`model.type.${m}`)),1)]),_:2},1032,["label"])),64))]),_:1},8,["modelValue"]),J("div",Ze,[_e((r(),U(x,{ref_key:"table",ref:k,data:u.value,onSelectionChange:_[5]||(_[5]=m=>o.value=m),onRowDblclick:_[6]||(_[6]=m=>M(m.id)),onSortChange:N},{default:a(()=>[e(t(He),{name:"model"},{default:a(()=>[e(W,{type:"selection",selectable:p,width:"45"}),e(W,{property:"id",label:"ID",width:"80",sortable:"custom"}),e(W,{property:"name",label:c.$t("model.name"),sortable:"custom","show-overflow-tooltip":""},null,8,["label"]),e(W,{property:"type",label:c.$t("model.type"),sortable:"custom",formatter:m=>c.$t(`model.type.${m.type}`)},null,8,["label","formatter"]),e(W,{property:"scope",label:c.$t("model.scope"),sortable:"custom"},{default:a(({row:m})=>[m.scope===2?(r(),U(G,{key:0,type:"success",size:"small"},{default:a(()=>[H(F(c.$t(`model.scope.${m.scope}`)),1)]),_:2},1024)):(r(),U(G,{key:1,type:"info",size:"small"},{default:a(()=>[H(F(c.$t(`model.scope.${m.scope}`)),1)]),_:2},1024))]),_:1},8,["label"]),e(W,{label:c.$t("table.action")},{default:a(({row:m})=>[e(z,{type:"primary",disabled:t(A)("model:update"),size:"small",link:"",onClick:()=>M(m.id)},{default:a(()=>[H(F(c.$t("edit")),1)]),_:2},1032,["disabled","onClick"]),["global","site"].includes(m.type)?S("",!0):(r(),U(z,{key:0,type:"primary",disabled:t(A)("model:update"),size:"small",link:"",onClick:()=>B(m.id)},{default:a(()=>[H(F(c.$t("model.fun.systemFields")),1)]),_:2},1032,["disabled","onClick"])),e(z,{type:"primary",disabled:t(A)("model:update"),size:"small",link:"",onClick:()=>j(m.id)},{default:a(()=>[H(F(c.$t("model.fun.customFields")),1)]),_:2},1032,["disabled","onClick"]),p(m)?(r(),U(R,{key:1,title:c.$t("confirmDelete"),onConfirm:()=>E([m.id])},{reference:a(()=>[e(z,{type:"primary",disabled:t(A)("model:delete"),size:"small",link:""},{default:a(()=>[H(F(c.$t("delete")),1)]),_:1},8,["disabled"])]),_:2},1032,["title","onConfirm"])):S("",!0)]),_:1},8,["label"])]),_:1})]),_:1},8,["data"])),[[ee,h.value]])]),e(Oe,{modelValue:s.value,"onUpdate:modelValue":_[7]||(_[7]=m=>s.value=m),"bean-id":n.value,"bean-ids":w.value,"model-type":$.value,onFinished:v},null,8,["modelValue","bean-id","bean-ids","model-type"]),e(We,{modelValue:g.value,"onUpdate:modelValue":_[8]||(_[8]=m=>g.value=m),"bean-id":n.value},null,8,["modelValue","bean-id"]),e(Xe,{modelValue:b.value,"onUpdate:modelValue":_[9]||(_[9]=m=>b.value=m),"bean-id":n.value},null,8,["modelValue","bean-id"])])}}});export{bl as default};
