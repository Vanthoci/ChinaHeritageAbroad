import{d as R,u as B,r as V,V as C,o as x,b as p,e as b,I as M,k as s,i as c,w as u,ag as S,ah as z,l as E,t as I,a1 as m,U as r}from"./index-53093fce.js";import{c as P,d as F}from"./stat-44c6c647.js";const L={class:"p-3 mt-3 app-block"},N={class:"p-3 mt-3 app-block"},q={class:"p-3 mt-3 app-block"},$=R({__name:"VisitRegion",setup(O){const{t:d,n:v}=B(),y=V("last30day"),Y=e=>{switch(e){case"today":return r().format("YYYY-MM-DD");case"yesterday":return r().subtract(1,"day").format("YYYY-MM-DD");case"last7day":return r().subtract(6,"day").format("YYYY-MM-DD");case"last30day":return r().subtract(29,"day").format("YYYY-MM-DD");case"lastYear":return r().subtract(1,"year").format("YYYY-MM-DD");default:return}},_=e=>e==="yesterday"?r().subtract(1,"day").format("YYYY-MM-DD"):r().format("YYYY-MM-DD"),g=C(),w=async e=>{const n=await P({begin:Y(e),end:_(e)}),l=n.reduce((t,f)=>t+f.pvCount,0),i={title:{text:d("menu.stat.visitCountry"),textStyle:{color:"#909399",fontWeight:"normal",fontSize:16}},tooltip:{trigger:"item",valueFormatter:t=>v(t*100/l,"decimal")+"%"},legend:{type:"scroll",orient:"vertical",right:"10%",top:16,bottom:16},series:[{name:d("menu.stat.visitCountry"),type:"pie",radius:"72%",center:["40%","56%"],data:n.map(t=>({value:t.pvCount,name:t.name}))}]},o=g.value;if(o==null)return;let a=m.getInstanceByDom(o);a==null&&(a=m.init(o)),a.setOption(i),window.addEventListener("resize",function(){a&&a.resize()})},h=C(),k=async e=>{const n=await F({begin:Y(e),end:_(e)}),l=n.reduce((t,f)=>t+f.pvCount,0),i={title:{text:d("menu.stat.visitProvince"),textStyle:{color:"#909399",fontWeight:"normal",fontSize:16}},tooltip:{trigger:"item",valueFormatter:t=>v(t*100/l,"decimal")+"%"},legend:{type:"scroll",orient:"vertical",right:"10%",top:16,bottom:16},series:[{name:d("menu.stat.visitProvince"),type:"pie",radius:"72%",center:["40%","56%"],data:n.map(t=>({value:t.pvCount,name:t.name}))}]},o=h.value;if(o==null)return;let a=m.getInstanceByDom(o);a==null&&(a=m.init(o)),a.setOption(i),window.addEventListener("resize",function(){a&&a.resize()})},D=async e=>{w(e),k(e)};return x(async()=>{D(y.value)}),(e,n)=>{const l=p("el-radio-button"),i=p("el-radio-group"),o=p("el-col"),a=p("el-row");return b(),M("div",null,[s("div",L,[s("div",null,[c(i,{modelValue:y.value,"onUpdate:modelValue":n[0]||(n[0]=t=>y.value=t),onChange:n[1]||(n[1]=t=>D(t))},{default:u(()=>[(b(),M(S,null,z(["today","yesterday","last7day","last30day","lastYear","all"],t=>c(l,{key:t,label:t},{default:u(()=>[E(I(e.$t(`visit.${t}`)),1)]),_:2},1032,["label"])),64))]),_:1},8,["modelValue"])])]),c(a,{gutter:12},{default:u(()=>[c(o,{span:12},{default:u(()=>[s("div",N,[s("div",{ref_key:"countryChartRef",ref:g,class:"h-80"},null,512)])]),_:1}),c(o,{span:12},{default:u(()=>[s("div",q,[s("div",{ref_key:"provinceChartRef",ref:h,class:"h-80"},null,512)])]),_:1})]),_:1})])}}});export{$ as default};
